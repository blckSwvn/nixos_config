#!/usr/bin/env bash
pkill waybar

export XDG_CURRENT_DESKTOP=river
export XDG_SESSION_TYPE=wayland
export XDG_SESSION_DESKTOP=river

systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP XDG_SESSION_TYPE
systemctl --user start xdg-desktop-portal-wlr.service &
systemctl --user start xdg-desktop-portal.service &

swaybg -i $HOME/pictures/wallpapers/wallpaper5.* &

sleep 1
waybar &
brightnessctl -d intel_backlight set 0 && brightnessctl -d tpacpi::kbd_backlight set 0 &

#startup
riverctl xcursor-theme Bibata-Modern-Ice
tileInit() {
rivercarro &
riverctl default-layout rivercarro
riverctl send-layout-cmd rivercarro "main-count 1"
riverctl send-layout-cmd rivercarro "main-ratio 0.5"
# riverctl send-layout-cmd rivercarro "gaps 10"
riverctl send-layout-cmd rivercarro "inner-gaps 5"
riverctl send-layout-cmd rivercarro "outer-gaps 5"
riverctl send-layout-cmd rivercarro "width-ratio 1"
riverctl send-layout-cmd rivercarro "no-smart-gaps"
riverctl send-layout-cmd rivercarro "no-smart-gaps"
riverctl send-layout-cmd rivercarro "main-location left"
}
riverctl focus-follows-cursor always

riverctl border-color-focused 0x70b0ff
riverctl border-color-unfocused 0x000000
riverctl border-width 1

riverctl rule-add '*' float=false

#input lang
riverctl keyboard-layout no

mod="Mod1"
mod2="Mod5"
mod3="Super"

#rules
riverctl rule-add -app-id kitty tags 1
riverctl rule-add -app-id librewolf tags 2

#map aka binds
#common lanching apps etc
riverctl map normal $mod s spawn "systemctl suspend"
riverctl map normal $mod+shift s spawn "waylock"
riverctl map normal $mod r spawn "$HOME/.config/river/wallpaper.sh"
riverctl map normal $mod2 Space spawn kitty
riverctl map normal $mod2 b spawn librewolf
riverctl map normal $mod2 f toggle-fullscreen
riverctl map normal $mod Q close
# riverctl map normal $mod2 g spawn "(grim -g "$(slurp)")"
riverctl map normal $mod Space spawn "wofi --show drun"
riverctl map normal $mod+Shift E exit
riverctl map normal $mod f toggle-float
riverctl map normal $mod3+Shift s spawn "DRI_PRIME=0 steam"

#playerctl wpctl
riverctl map normal $mod p spawn "playerctl play-pause"
riverctl map normal $mod Right spawn "playerctl next" 
riverctl map normal $mod Left spawn "playerctl previous"
riverctl map normal $mod Up spawn "wpctl set-volume @DEFAULT_AUDIO_SINK@ 10%+"
riverctl map normal $mod Down spawn "wpctl set-volume @DEFAULT_AUDIO_SINK@ 10%-"

#brightness ctl
riverctl map normal $mod+Shift Up spawn "brightnessctl set 10%+"
riverctl map normal $mod+Shift Down spawn "brightnessctl set 10%-"

riverctl map normal $mod+Shift h focus-output left 
riverctl map normal $mod+Shift l send-to-output right

#navigation
riverctl map normal $mod h focus-view left
riverctl map normal $mod l focus-view right
riverctl map normal $mod j focus-view down
riverctl map normal $mod k focus-view up

#snap FLOATING windows
riverctl map normal $mod2 h snap left
riverctl map normal $mod2 l snap right
riverctl map normal $mod2 j snap down
riverctl map normal $mod2 k snap up
riverctl map normal $mod3 h focus-output left
riverctl map normal $mod3 j focus-output down
riverctl map normal $mod3 k focus-output upup
riverctl map normal $mod3 l focus-output right
riverctl map normal $mod3+$mod h send-to-output left
riverctl map normal $mod3+$mod j send-to-output down
riverctl map normal $mod3+$mod k send-to-output upup
riverctl map normal $mod3+$mod l send-to-output right
riverctl map normal $mod3+Shift k send-layout-cmd rivercarro "main-count +1";
riverctl map normal $mod3+Shift j send-layout-cmd rivercarro "main-count -1"
riverctl map normal $mod3+Shift c send-layout-cmd rivercarro "main-location-cycle left,top,right"
riverctl map normal $mod3+Shift h send-layout-cmd rivercarro "main-ratio +0.1"
riverctl map normal $mod3+Shift l send-layout-cmd rivercarro "main-ratio -0.1"
#tags
#switch what tag you see
riverctl map normal $mod+Shift 1 toggle-focused-tags 1
riverctl map normal $mod+Shift 2 toggle-focused-tags 2
riverctl map normal $mod+Shift 3 toggle-focused-tags 4
riverctl map normal $mod+Shift 4 toggle-focused-tags 8
riverctl map normal $mod+Shift 5 toggle-focused-tags 16
riverctl map normal $mod+Shift 6 toggle-focused-tags 32
riverctl map normal $mod+Shift 7 toggle-focused-tags 64
riverctl map normal $mod+Shift 8 toggle-focused-tags 128
riverctl map normal $mod+Shift 9 toggle-focused-tags 256
riverctl map normal $mod+Shift 0 toggle-focused-tags 512

riverctl map normal $mod2+Shift 1 set-view-tags 1
riverctl map normal $mod2+Shift 2 set-view-tags 2
riverctl map normal $mod2+Shift 3 set-view-tags 4
riverctl map normal $mod2+Shift 4 set-view-tags 8
riverctl map normal $mod2+Shift 5 set-view-tags 16
riverctl map normal $mod2+Shift 6 set-view-tags 32
riverctl map normal $mod2+Shift 7 set-view-tags 64
riverctl map normal $mod2+Shift 8 set-view-tags 128
riverctl map normal $mod2+Shift 9 set-view-tags 256
riverctl map normal $mod2+Shift 0 set-view-tags 512
#assigning tag to window

riverctl map normal $mod 1 set-focused-tags 1
riverctl map normal $mod 2 set-focused-tags 2
riverctl map normal $mod 3 set-focused-tags 4
riverctl map normal $mod 4 set-focused-tags 8
riverctl map normal $mod 5 set-focused-tags 16
riverctl map normal $mod 6 set-focused-tags 32
riverctl map normal $mod 7 set-focused-tags 64
riverctl map normal $mod 8 set-focused-tags 128
riverctl map normal $mod 9 set-focused-tags 256
riverctl map normal $mod 0 set-focused-tags 512

tileInit
riverctl focus-output next
tileInit

wlr-randr --output HDMI-A-1 --pos 0,0
wlr-randr --output eDP-1 --pos 1920,0
